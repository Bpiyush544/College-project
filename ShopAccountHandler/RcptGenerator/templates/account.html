{% extends 'base.html' %}


{% block style %}
.dropbtn {
    background-color: #04AA6D;
    color: white;
    padding: 16px;
    font-size: 16px;
    border: none;
    cursor: pointer;
  }
  
  .dropbtn:hover, .dropbtn:focus {
    background-color: #3e8e41;
  }
  
  #myInput {
    box-sizing: border-box;
    background-image: url('searchicon.png');
    background-position: 14px 12px;
    background-repeat: no-repeat;
    font-size: 16px;
    padding: 14px 20px 12px 45px;
    border: none;
    border-bottom: 1px solid #ddd;
  }
  
  #myInput:focus {outline: 3px solid #ddd;}
  
  .dropdown {
    position: relative;
    display: inline-block;
  }
  
  .dropdown-content {
    display: none;
    position: absolute;
    background-color: #f6f6f6;
    min-width: 230px;
    overflow: auto;
    border: 1px solid #ddd;
    z-index: 1;
  }
  
  .dropdown-content button {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
  }
  {% comment %} use here {% endcomment %}
  
  .dropdown button:hover {background-color: #ddd;} 
  {% comment %} use here {% endcomment %}
  
  .show {display: block;}
{% endblock style %}


{% block title %}
    new page
{% endblock title %}

{% block content %}
    {{customer.first_name}}
    <br>
    {{customer.username}}
<br>
<br>
<script>
  sessionStorage.clear();
</script>
<h1>Current Money   - <span>{{amount}}</span></h1> 
<a href="{% url 'add_money' customer.username %}"> 
  ADD MONEY
</a>
<h2>
  You Can Add the Reciepts Here
</h2>
<div class="dropdown">
  <button onclick="myFunction()" class="dropbtn">Products</button>
  <div id="myDropdown" class="dropdown-content">
    <input type="text" placeholder="Search.." id="myInput" onkeyup="filterFunction()">
    {% for product in Products %}
      <button style="border:none" onclick="myFunc({{product.name}})" id="{{product.name}}">{{product.name}}</button>
    {% endfor %}
  </div><br><br>
  <label for="quantity">Quantity:</label>
  <input type="number" id="quantity" name="quantity" max="50" value=1>
  <button onclick="showReciept()">Show Button</button>
    <ul id="reciept">
    </ul>
  {% comment %} <button type="button">hello</button> {% endcomment %}
</div>
<form method="post" action="/accountHolders/{{customer.username}}">
    {% csrf_token %}
    <div class="form-group">
        <label for="username">Username</label>
    <div class="form-row">
        <div class="col">
        <input type="text" name = "username" class="form-control" value="{{customer.username}} ">
    </div>
    <div class="form-group">
        <label for="firstname">FirstName</label>
    <div class="form-row">
        <div class="col">
        <input type="text" name = "firstname" class="form-control" value="{{customer.first_name}} ">
    </div>
    <div class="form-group">
    <div class="form-row">
        <div class="col">
        <input id="data" type="text" name = "data" class="form-control" value="">
    </div>
    {% comment %} <div class="form-group col-md-4">
        <label for="inputState">Product</label>
        <select id="inputState" class="form-control" name="product">
            {% for product in Products %}
                <option selected>{{product}}</option>
            {% endfor %}
        </select>
      </div> {% endcomment %}
      <br>
      <br>
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
  <br>
  <br>
  <br>
  <br>
  <h1>Receipt History</h1>
  <a href="{% url 'history' customer.username %}">History</a>
  <script>
    /* When the user clicks on the button,
    toggle between hiding and showing the dropdown content */
    function myFunction() {
      document.getElementById("myDropdown").classList.toggle("show");
    }
    function filterFunction() {
      var input, filter, ul, li, a, i;
      input = document.getElementById("myInput");
      filter = input.value.toUpperCase();
      div = document.getElementById("myDropdown");
      a = div.getElementsByTagName("button");
      for (i = 0; i < a.length; i++) {
        txtValue = a[i].textContent || a[i].innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          a[i].style.display = "";
        } else {
          a[i].style.display = "none";
        }
      }
    }
    const myFunc = (val) => {
      var quantity = document.getElementById('quantity').value;
      if(sessionStorage.getItem(val.innerText)!==null){
        var temp = parseInt(sessionStorage.getItem(val.innerText));
        temp = temp + parseInt(quantity);
        sessionStorage.setItem(val.innerText,temp);
      }else{
        sessionStorage.setItem(val.innerText,quantity);
      }
    }

    function showReciept(){
      document.getElementById('reciept').innerHTML = '';
      document.getElementById("data").value = "";
      //data = "";
        reciept = document.getElementById('reciept');

        var ul = document.getElementById("reciept");
        for(i = 0; i<sessionStorage.length; i++){
          var li = document.createElement("li");
          li.innerText = sessionStorage.key(i);
          li.innerText += " :";
          li.innerText += sessionStorage.getItem(sessionStorage.key(i));
          //console.log(typeof(sessionStorage.key(i)));
          document.getElementById("data").value+= sessionStorage.key(i);
          document.getElementById("data").value+= '-';
          document.getElementById("data").value+= sessionStorage.getItem(sessionStorage.key(i));
          document.getElementById("data").value+=',';
          ul.append(li);
        }
        
        //document.getElementById("data").value+= "hello";
    }
    </script>

  {% endblock content %}
  

  
  
  
  
  
{% comment %}   
  product selected would be the one i click then i would have to choose the amount initially the amount would be
  1 but could be customised if the owner wants to do so {% endcomment %}
  
  {% comment %} 
  I want a page which would let us add money if someone pays us the money
  
  {% endcomment %}
  
  
  
  

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

  
  
  
  
  
  
  
  {% comment %} {% for Rec in Receipts %}
    {% if Rec.username == customer.username %}
        {{Rec.prod_name}}
    {% endif %}
    {{cus}}
  {% endfor %} {% endcomment %}

  {% comment %} {% if not Receipt %}
  <h2>No History available</h2>
  {% else %}
  {% for Rec in Receipt %}
      <li>{{Rec.prod_name}}</li>
  {% endfor %}
  {% endif %} {% endcomment %}